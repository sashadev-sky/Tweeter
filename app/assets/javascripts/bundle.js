!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var r={followUser:function(e){return r.changeFollowStatus(e,"POST")},unfollowUser:function(e){return r.changeFollowStatus(e,"DELETE")},changeFollowStatus:function(e,t){return $.ajax({url:"/users/".concat(e,"/follow"),dataType:"json",method:t})},searchUsers:function(e){return $.ajax({url:"/users/search",dataType:"json",method:"GET",data:{query:e}})},createTweet:function(e){return $.ajax({url:"/tweets",method:"POST",dataType:"json",data:e})},fetchTweets:function(e){return $.ajax({url:"/feed",method:"GET",dataType:"json",data:e})}},i=r;function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,l=void 0,l=function(e,t){if("object"!==o(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===o(l)?l:String(l)),r)}var i,l}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=$(t),this.userId=this.$el.data("user-id")||n.userId,this.followState=this.$el.data("initial-follow-state")||n.followState,this.render(),this.$el.click(_.debounce(this.handleClick.bind(this),250,{leading:!0,trailing:!1}))}var t,n,r;return t=e,(n=[{key:"handleClick",value:function(e){var t=this,n=this.followState;"this is you!"===n||current_user===this.userId?this.render():"followed"===n?(this.$el.prop("disabled",!0),i.unfollowUser(this.userId).then((function(){t.followState="unfollowed",t.render()}))):"unfollowed"===n&&(this.$el.prop("disabled",!0),i.followUser(this.userId).then((function(){t.followState="followed",t.render()})))}},{key:"render",value:function(){switch(this.followState){case"followed":this.$el.prop("disabled",!1),this.$el.html("Unfollow!");break;case"unfollowed":this.$el.prop("disabled",!1),this.$el.html("Follow!");break;case"this is you!":this.$el.prop("disabled",!0),this.$el.addClass("user-self"),this.$el.html("this is you!")}}}])&&l(t.prototype,n),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==a(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===a(o)?o:String(o)),r)}var i,o}var c=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=$(t),this.$input=this.$el.find("input[name=username]"),this.$ul=this.$el.find(".users"),this.$el.find(".simple-form").submit((function(){return!1})),this.$input.on("input",_.debounce(this.handleInput.bind(this),275))}var t,n,r;return t=e,(n=[{key:"handleInput",value:function(e){var t=this,n=this.$input.val();(n=n.replace(/\s+/g,""))?" "!==e.originalEvent.data&&i.searchUsers(n).then((function(e){return t.render(e)})):this.$ul.html("")}},{key:"render",value:function(e){this.$ul.empty(),0===e.length?(this.$ul.html("No results matched your search"),this.$ul.addClass("no-results")):this.$ul.removeClass("no-results");for(var t=0;t<e.length;t++){var n=e[t],r=$("<a></a>");r.text("@".concat(n.username)),r.attr("href","/users/".concat(n.id));var i=$("<li></li>");if(i.append(r),current_user){var o=$("<button></button>");n.id!==current_user?new u(o,{userId:n.id,followState:n.followed?"followed":"unfollowed"}):new u(o,{userId:n.id,followState:"this is you!"}),i.append(o)}this.$ul.append(i)}}}])&&s(t.prototype,n),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==f(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==f(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===f(o)?o:String(o)),r)}var i,o}var h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=$(t),this.$input=this.$el.find("textarea[name=tweet\\[content\\]]"),this.$input.on("input",this.handleInput.bind(this)),this.$mentionedUsersDiv=this.$el.find(".mentioned-users"),this.$el.find(".add-mentioned-user").on("click",this.addMentionedUser.bind(this)),this.$mentionedUsersDiv.on("click",".remove-mentioned-user",this.removeMentionedUser.bind(this)),this.$el.on("submit",this.submit.bind(this))}var t,n,r;return t=e,(n=[{key:"addMentionedUser",value:function(e){e.preventDefault(),this.$mentionedUsersDiv.append(this.newUserSelect())}},{key:"clearInput",value:function(){this.$input.val(""),this.$mentionedUsersDiv.find("div").empty(),this.$el.prop("disabled",!1),this.$el.find(":input").prop("disabled",!1),this.$el.find(".char-left").empty()}},{key:"handleInput",value:function(e){var t=this.$input.val().length;this.$el.find(".char-left").text("".concat(140-t," characters left"))}},{key:"handleSuccess",value:function(e){$(this.$el.data("tweets-ul")).trigger("insert-tweet",e),this.clearInput()}},{key:"newUserSelect",value:function(){var e=window.users.map((function(e){return"<option value='".concat(e.id,"'>").concat(e.username,"</option>")})).join(""),t="\n      <div>\n        <select name='tweet[mentioned_user_ids][]'>\n          ".concat(e,"\n        </select>\n        <button class='remove-mentioned-user'>Remove</button>\n      </div>");return $(t)}},{key:"removeMentionedUser",value:function(e){e.preventDefault(),$(e.currentTarget).parent().remove()}},{key:"submit",value:function(e){var t=this,n=this.$el.serializeJSON();e.preventDefault(),n.tweet.content&&(this.$el.prop("disabled",!0),this.$el.find(":input").prop("disabled",!0),i.createTweet(n).then((function(e){return t.handleSuccess(e)})))}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"),"symbol"===p(o)?o:String(o)),r)}var i,o}var m=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=$(t),this.lastCreatedAt=null,this.$el.on("click",".fetch-more",this.fetchTweets.bind(this)),this.$el.on("insert-tweet",this.insertTweet.bind(this))}var t,n,r;return t=e,(n=[{key:"insertTweet",value:function(e,t){this.$el.find("ul.tweets").prepend(this.tweetElement(t)),this.lastCreatedAt||(this.lastCreatedAt=t.created_at)}},{key:"insertTweets",value:function(e){this.$el.find("ul.tweets").append(e.map(this.tweetElement))}},{key:"fetchTweets",value:function(e){e.preventDefault();var t=this,n={};this.lastCreatedAt&&(n.max_created_at=this.lastCreatedAt),i.fetchTweets(n).then((function(e){t.insertTweets(e),e.length<20&&t.$el.find(".fetch-more").replaceWith("<b>No more tweets!</b>"),e.length>0&&(t.lastCreatedAt=e[e.length-1].created_at)}))}},{key:"tweetElement",value:function(e){var t=e.mentions.map((function(e){return"<li class='tweetee'>\n        <a href='/users/".concat(e.user.id,"'>@").concat(e.user.username,"</a>\n      </li>")})).join(",&nbsp;"),n="\n    <div class='tweet'>\n      <h3 class='tweeter'>\n        <a href='/users/".concat(e.user.id,"'>\n          @").concat(e.user.username,"&nbsp;\n        </a>\n      </h3>\n\n      <p>").concat(e.content,"</p>\n\n      <ul>Mentions:&nbsp;\n        ").concat(t,"\n      </ul>\n    </div>");return $(n)}}])&&y(t.prototype,n),r&&y(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();$((function(){$("div.infinite-tweets").each((function(e,t){return new m(t)})),$("button.follow-toggle").each((function(e,t){return new u(t,{})})),$(".users-search").each((function(e,t){return new c(t)})),$("form.tweet-compose").each((function(e,t){return new h(t)}))}))}]);
//# sourceMappingURL=bundle.js.map